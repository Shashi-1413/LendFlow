import{r as u,a as ee,R as se}from"./vendor-nf7bT_Uh.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))d(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const f of s.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&d(f)}).observe(document,{childList:!0,subtree:!0});function h(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerPolicy&&(s.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?s.credentials="include":t.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function d(t){if(t.ep)return;t.ep=!0;const s=h(t);fetch(t.href,s)}})();var z={exports:{}},O={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var te=u,re=Symbol.for("react.element"),ae=Symbol.for("react.fragment"),ne=Object.prototype.hasOwnProperty,le=te.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ce={key:!0,ref:!0,__self:!0,__source:!0};function K(n,r,h){var d,t={},s=null,f=null;h!==void 0&&(s=""+h),r.key!==void 0&&(s=""+r.key),r.ref!==void 0&&(f=r.ref);for(d in r)ne.call(r,d)&&!ce.hasOwnProperty(d)&&(t[d]=r[d]);if(n&&n.defaultProps)for(d in r=n.defaultProps,r)t[d]===void 0&&(t[d]=r[d]);return{$$typeof:re,type:n,key:s,ref:f,props:t,_owner:le.current}}O.Fragment=ae;O.jsx=K;O.jsxs=K;z.exports=O;var e=z.exports,U={},V=ee;U.createRoot=V.createRoot,U.hydrateRoot=V.hydrateRoot;const oe=({currentView:n,onViewChange:r})=>{const h=[{key:"dashboard",label:"Dashboard",icon:"📊"},{key:"customers",label:"Customers",icon:"👥"},{key:"loans",label:"Loans",icon:"💰"},{key:"payments",label:"Payments",icon:"💳"},{key:"database",label:"Database",icon:"🗄️"}],d=t=>{try{r(t)}catch(s){console.error("Error changing view:",s)}};return e.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("h1",{className:"text-2xl font-bold text-primary-600",children:"🏦 LendFlow"})}),e.jsx("div",{className:"hidden md:block ml-4",children:e.jsx("p",{className:"text-sm text-gray-600",children:"Professional Loan Management"})})]}),e.jsx("nav",{className:"hidden md:flex space-x-8",children:h.map(t=>e.jsxs("button",{onClick:()=>d(t.key),className:`inline-flex items-center px-3 py-2 rounded-md text-sm font-medium transition-colors duration-200 ${n===t.key?"bg-primary-100 text-primary-700":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:[e.jsx("span",{className:"mr-2",children:t.icon}),t.label]},t.key))}),e.jsx("div",{className:"md:hidden",children:e.jsx("select",{value:n,onChange:t=>d(t.target.value),className:"input-field text-sm",children:h.map(t=>e.jsxs("option",{value:t.key,children:[t.icon," ",t.label]},t.key))})})]})})})},ie="/api/v1",de=1e4,P=async(n,r={})=>{try{const h=`${ie}${n}`,d={timeout:de,headers:{"Content-Type":"application/json",...r.headers},...r},t=await fetch(h,d);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return{data:await t.json()}}catch(h){throw console.error("API Error:",h),h}},B={getAll:()=>P("/customers"),getById:n=>P(`/customers/${n}`),create:n=>P("/customers",{method:"POST",body:JSON.stringify(n)}),update:(n,r)=>P(`/customers/${n}`,{method:"PUT",body:JSON.stringify(r)}),delete:n=>P(`/customers/${n}`,{method:"DELETE"})},_={getAll:(n={})=>{const r=new URLSearchParams(n).toString(),h=r?`/loans?${r}`:"/loans";return P(h)},getById:n=>P(`/loans/${n}`),create:n=>P("/loans",{method:"POST",body:JSON.stringify(n)}),updateStatus:(n,r)=>P(`/loans/${n}`,{method:"PATCH",body:JSON.stringify({status:r})}),update:(n,r)=>P(`/loans/${n}`,{method:"PUT",body:JSON.stringify(r)}),delete:n=>P(`/loans/${n}`,{method:"DELETE"})},q={getAll:()=>P("/payments"),getById:n=>P(`/payments/${n}`),getByLoan:n=>P(`/loans/${n}/payments`),getByLoanId:n=>P(`/payments/loan/${n}`),create:(n,r)=>P(`/loans/${n}/payments`,{method:"POST",body:JSON.stringify(r)}),update:(n,r)=>P(`/payments/${n}`,{method:"PUT",body:JSON.stringify(r)}),delete:n=>P(`/payments/${n}`,{method:"DELETE"})},me={getStats:()=>P("/dashboard")},H=({onNotification:n})=>{const[r,h]=u.useState(!0),[d,t]=u.useState(null),[s,f]=u.useState(null);u.useEffect(()=>{i()},[]);const i=async()=>{try{h(!0),f(null);const l=await me.getStats();t(l.data.data)}catch(l){console.error("Dashboard fetch error:",l),f(l.message),n&&n({type:"error",message:`Failed to load dashboard: ${l.message}`})}finally{h(!1)}},N=l=>{try{return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(l||0)}catch(a){return console.error("Error formatting currency:",a),`₹${l||0}`}},j=l=>{try{return new Date(l).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch(a){return console.error("Error formatting date:",a),"Invalid Date"}};if(r)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"loading-spinner"})});if(s||!d)return e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-error-600 mb-4",children:"⚠️ Dashboard Error"}),e.jsx("p",{className:"text-gray-500 mb-4",children:s||"Failed to load dashboard data"}),e.jsx("button",{onClick:i,className:"btn-primary",children:"🔄 Retry"})]});const{stats:k,recentLoans:p,recentPayments:S}=d,m=[{title:"Total Customers",value:k.totalCustomers||0,icon:"👥",color:"bg-primary-500"},{title:"Total Loans",value:k.totalLoans||0,icon:"💰",color:"bg-success-500"},{title:"Active Loans",value:k.activeLoans||0,icon:"📈",color:"bg-warning-500"},{title:"Paid Off Loans",value:k.paidOffLoans||0,icon:"✅",color:"bg-success-600"},{title:"Total Loan Amount",value:N(k.totalLoanAmount),icon:"💵",color:"bg-indigo-500"},{title:"Total Collected",value:N(k.totalCollected),icon:"💳",color:"bg-green-600"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Dashboard"}),e.jsx("button",{onClick:i,className:"btn-secondary",disabled:r,children:"🔄 Refresh"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:m.map((l,a)=>e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`p-3 rounded-full ${l.color} text-white`,children:e.jsx("span",{className:"text-xl",children:l.icon})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:l.title}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:l.value})]})]})},a))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Loans"}),!p||p.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No recent loans"}):e.jsx("div",{className:"space-y-3",children:p.map(l=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:l.loanId}),e.jsxs("p",{className:"text-sm text-gray-500",children:[N(l.amount)," • ",j(l.createdAt)]})]}),e.jsx("span",{className:`status-${l.status.toLowerCase()}`,children:l.status})]},l.loanId))})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Payments"}),!S||S.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No recent payments"}):e.jsx("div",{className:"space-y-3",children:S.map(l=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:l.paymentId}),e.jsxs("p",{className:"text-sm text-gray-500",children:[l.loanId," • ",j(l.paymentDate)]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-medium text-success-600",children:N(l.amount)}),e.jsx("p",{className:"text-xs text-gray-500",children:l.paymentMethod})]})]},l.paymentId))})]})]})]})},Q=({onSuccess:n,onCancel:r,onNotification:h})=>{const[d,t]=u.useState({name:"",email:"",phone:"",address:""}),[s,f]=u.useState(!1),[i,N]=u.useState({}),j=()=>{try{const m={};return d.name.trim()?d.name.trim().length<2&&(m.name="Name must be at least 2 characters"):m.name="Name is required",d.email.trim()?/^\S+@\S+\.\S+$/.test(d.email)||(m.email="Please enter a valid email"):m.email="Email is required",d.phone.trim()?/^\+?[\d\s-()]+$/.test(d.phone)||(m.phone="Please enter a valid phone number"):m.phone="Phone number is required",d.address.trim()||(m.address="Address is required"),N(m),Object.keys(m).length===0}catch(m){return console.error("Error validating form:",m),!1}},k=async m=>{m.preventDefault();try{if(!j())return;f(!0),N({});const l={name:d.name.trim(),email:d.email.trim().toLowerCase(),phone:d.phone.trim(),address:d.address.trim()};await B.create(l),n&&n()}catch(l){console.error("Error creating customer:",l),h&&h({type:"error",message:`Failed to create customer: ${l.message}`})}finally{f(!1)}},p=(m,l)=>{try{t(a=>({...a,[m]:l})),i[m]&&N(a=>({...a,[m]:""}))}catch(a){console.error("Error handling form change:",a)}},S=()=>{try{r&&r()}catch(m){console.error("Error handling cancel:",m)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Add New Customer"}),e.jsx("button",{onClick:S,className:"btn-secondary",disabled:s,children:"← Back to Customers"})]}),e.jsx("div",{className:"card max-w-2xl",children:e.jsxs("form",{onSubmit:k,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name *"}),e.jsx("input",{type:"text",id:"name",value:d.name,onChange:m=>p("name",m.target.value),className:`input-field ${i.name?"border-error-300 focus:border-error-500 focus:ring-error-500":""}`,placeholder:"Enter customer's full name",disabled:s}),i.name&&e.jsx("p",{className:"error-message",children:i.name})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address *"}),e.jsx("input",{type:"email",id:"email",value:d.email,onChange:m=>p("email",m.target.value),className:`input-field ${i.email?"border-error-300 focus:border-error-500 focus:ring-error-500":""}`,placeholder:"customer@example.com",disabled:s}),i.email&&e.jsx("p",{className:"error-message",children:i.email})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number *"}),e.jsx("input",{type:"tel",id:"phone",value:d.phone,onChange:m=>p("phone",m.target.value),className:`input-field ${i.phone?"border-error-300 focus:border-error-500 focus:ring-error-500":""}`,placeholder:"+1 (555) 123-4567",disabled:s}),i.phone&&e.jsx("p",{className:"error-message",children:i.phone})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700 mb-1",children:"Address *"}),e.jsx("textarea",{id:"address",rows:3,value:d.address,onChange:m=>p("address",m.target.value),className:`input-field ${i.address?"border-error-300 focus:border-error-500 focus:ring-error-500":""}`,placeholder:"Enter complete address",disabled:s}),i.address&&e.jsx("p",{className:"error-message",children:i.address})]}),e.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[e.jsx("button",{type:"button",onClick:S,className:"btn-secondary",disabled:s,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary",disabled:s,children:s?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"inline-block w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Creating..."]}):"✅ Create Customer"})]})]})})]})},xe=({onNotification:n})=>{const[r,h]=u.useState([]),[d,t]=u.useState(!0),[s,f]=u.useState(null),[i,N]=u.useState(!1),[j,k]=u.useState({search:""});u.useEffect(()=>{p()},[]);const p=async()=>{try{t(!0),f(null);const a=await B.getAll();h(a.data.data||[])}catch(a){console.error("Customer fetch error:",a),f(a.message),n&&n({type:"error",message:`Failed to load customers: ${a.message}`})}finally{t(!1)}},S=()=>{try{N(!1),p(),n&&n({type:"success",message:"Customer created successfully!"})}catch(a){console.error("Error handling customer creation:",a)}},m=a=>{try{return new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch(b){return console.error("Error formatting date:",b),"Invalid Date"}},l=r.filter(a=>{var b,x,v,o;try{if(!j.search)return!0;const g=j.search.toLowerCase();return((b=a.name)==null?void 0:b.toLowerCase().includes(g))||((x=a.email)==null?void 0:x.toLowerCase().includes(g))||((v=a.phone)==null?void 0:v.includes(g))||((o=a.customerId)==null?void 0:o.toLowerCase().includes(g))}catch(g){return console.error("Error filtering customers:",g),!0}});return i?e.jsx(Q,{onSuccess:S,onCancel:()=>N(!1),onNotification:n}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Customers"}),e.jsxs("button",{onClick:()=>N(!0),className:"btn-primary flex items-center space-x-2",children:[e.jsx("span",{children:"👤"}),e.jsx("span",{children:"Add Customer"})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search customers by name, email, phone, or ID...",value:j.search,onChange:a=>k(b=>({...b,search:a.target.value})),className:"input-field"})}),e.jsx("button",{onClick:p,className:"btn-secondary",disabled:d,children:"🔄 Refresh"})]}),d&&e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"loading-spinner"})}),s&&!d&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-error-600 mb-4",children:"⚠️ Error Loading Customers"}),e.jsx("p",{className:"text-gray-500 mb-4",children:s}),e.jsx("button",{onClick:p,className:"btn-primary",children:"🔄 Retry"})]}),!d&&!s&&e.jsxs("div",{className:"card",children:[l.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-6xl mb-4",children:"👥"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:j.search?"No customers found":"No customers yet"}),e.jsx("p",{className:"text-gray-500 mb-4",children:j.search?"Try adjusting your search criteria":"Add your first customer to get started"}),!j.search&&e.jsx("button",{onClick:()=>N(!0),className:"btn-primary",children:"➕ Add Customer"})]}):e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Address"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Joined"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer ID"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.map(a=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:a.name}),e.jsx("div",{className:"text-sm text-gray-500",children:a.email})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:a.phone})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900 max-w-xs truncate",children:a.address})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:m(a.createdAt)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("code",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:a.customerId})})]},a.customerId))})]})}),l.length>0&&e.jsx("div",{className:"bg-gray-50 px-6 py-3 border-t border-gray-200",children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",l.length," of ",r.length," customers"]})})]})]})},Y=({onSuccess:n,onCancel:r,onNotification:h})=>{const[d,t]=u.useState([]),[s,f]=u.useState({customerId:"",amount:"",interestRate:"",term:""}),[i,N]=u.useState(!1),[j,k]=u.useState(!0),[p,S]=u.useState({}),[m,l]=u.useState(null),[a,b]=u.useState(!1),[x,v]=u.useState({name:"",email:"",phone:"",address:""}),[o,g]=u.useState(!1),[C,I]=u.useState({});u.useEffect(()=>{D()},[]),u.useEffect(()=>{s.amount&&s.interestRate&&s.term?y():l(null)},[s.amount,s.interestRate,s.term]);const D=async()=>{try{k(!0);const c=await B.getAll();t(c.data.data||[])}catch(c){console.error("Error fetching customers:",c),h&&h({type:"error",message:`Failed to load customers: ${c.message}`})}finally{k(!1)}},y=()=>{try{const c=parseFloat(s.amount),w=parseFloat(s.interestRate),E=parseInt(s.term);if(isNaN(c)||isNaN(w)||isNaN(E)){l(null);return}const A=w/100/12;let M;A===0?M=c/E:M=c*(A*Math.pow(1+A,E))/(Math.pow(1+A,E)-1);const J=M*E;l({monthlyPayment:Math.round(M*100)/100,totalAmount:Math.round(J*100)/100,totalInterest:Math.round((J-c)*100)/100})}catch(c){console.error("Error calculating payment:",c),l(null)}},F=()=>{try{const c={};return x.name.trim()?x.name.length<2&&(c.name="Name must be at least 2 characters long"):c.name="Customer name is required",x.email.trim()?/^\S+@\S+\.\S+$/.test(x.email)||(c.email="Please enter a valid email address"):c.email="Email is required",x.phone.trim()?/^\+?[\d\s-()]+$/.test(x.phone)||(c.phone="Please enter a valid phone number"):c.phone="Phone number is required",x.address.trim()||(c.address="Address is required"),I(c),Object.keys(c).length===0}catch(c){return console.error("Error validating customer form:",c),!1}},L=async c=>{c.preventDefault();try{if(!F())return;g(!0),I({});const E=(await B.create(x)).data.data;t(A=>[E,...A]),f(A=>({...A,customerId:E.customerId})),v({name:"",email:"",phone:"",address:""}),b(!1),h&&h({type:"success",message:`Customer "${E.name}" created successfully!`})}catch(w){console.error("Error creating customer:",w),h&&h({type:"error",message:`Failed to create customer: ${w.message}`})}finally{g(!1)}},R=(c,w)=>{try{v(E=>({...E,[c]:w})),C[c]&&I(E=>({...E,[c]:""}))}catch(E){console.error("Error handling customer form change:",E)}},G=()=>{try{const c={};if(s.customerId||(c.customerId="Please select a customer"),!s.amount)c.amount="Loan amount is required";else{const w=parseFloat(s.amount);isNaN(w)||w<=0?c.amount="Amount must be a positive number":w<1e3?c.amount="Minimum loan amount is ₹1,000":w>1e8&&(c.amount="Maximum loan amount is ₹10,00,00,000")}if(!s.interestRate)c.interestRate="Interest rate is required";else{const w=parseFloat(s.interestRate);isNaN(w)||w<=0?c.interestRate="Interest rate must be a positive number":w<.1?c.interestRate="Minimum interest rate is 0.1%":w>50&&(c.interestRate="Maximum interest rate is 50%")}if(!s.term)c.term="Loan term is required";else{const w=parseInt(s.term);isNaN(w)||w<=0?c.term="Term must be a positive number":w<1?c.term="Minimum term is 1 month":w>360&&(c.term="Maximum term is 360 months")}return S(c),Object.keys(c).length===0}catch(c){return console.error("Error validating form:",c),!1}},Z=async c=>{c.preventDefault();try{if(!G())return;N(!0),S({});const w={customerId:s.customerId,amount:parseFloat(s.amount),interestRate:parseFloat(s.interestRate),term:parseInt(s.term)};await _.create(w),n&&n()}catch(w){console.error("Error creating loan:",w),h&&h({type:"error",message:`Failed to create loan: ${w.message}`})}finally{N(!1)}},T=(c,w)=>{try{f(E=>({...E,[c]:w})),p[c]&&S(E=>({...E,[c]:""}))}catch(E){console.error("Error handling form change:",E)}},$=c=>{try{return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(c||0)}catch(w){return console.error("Error formatting currency:",w),`₹${c||0}`}},X=()=>{try{r&&r()}catch(c){console.error("Error handling cancel:",c)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Create New Loan"}),e.jsx("button",{onClick:X,className:"btn-secondary",disabled:i,children:"← Back to Loans"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx("div",{className:"card",children:e.jsxs("form",{onSubmit:Z,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("label",{htmlFor:"customerId",className:"block text-sm font-medium text-gray-700",children:"Customer *"}),e.jsx("button",{type:"button",onClick:()=>b(!a),className:`text-sm font-medium transition-colors ${a?"text-gray-600 hover:text-gray-800":"text-blue-600 hover:text-blue-800"}`,disabled:i||o,children:a?"← Back to Selection":"👤 + Add New Customer"})]}),a?e.jsxs("div",{className:"border border-blue-200 rounded-lg p-4 bg-blue-50",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center mr-3",children:e.jsx("span",{className:"text-white text-sm font-bold",children:"👤"})}),e.jsx("h3",{className:"text-lg font-medium text-blue-900",children:"Create New Customer"})]}),e.jsxs("form",{onSubmit:L,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"customerName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name *"}),e.jsx("input",{type:"text",id:"customerName",value:x.name,onChange:c=>R("name",c.target.value),className:`input-field ${C.name?"border-error-300 focus:border-error-500 focus:ring-error-500":""}`,placeholder:"Enter full name",disabled:o}),C.name&&e.jsx("p",{className:"error-message",children:C.name})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"customerEmail",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address *"}),e.jsx("input",{type:"email",id:"customerEmail",value:x.email,onChange:c=>R("email",c.target.value),className:`input-field ${C.email?"border-error-300 focus:border-error-500 focus:ring-error-500":""}`,placeholder:"email@example.com",disabled:o}),C.email&&e.jsx("p",{className:"error-message",children:C.email})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"customerPhone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number *"}),e.jsx("input",{type:"tel",id:"customerPhone",value:x.phone,onChange:c=>R("phone",c.target.value),className:`input-field ${C.phone?"border-error-300 focus:border-error-500 focus:ring-error-500":""}`,placeholder:"+91-XXXXXXXXXX",disabled:o}),C.phone&&e.jsx("p",{className:"error-message",children:C.phone})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"customerAddress",className:"block text-sm font-medium text-gray-700 mb-1",children:"Address *"}),e.jsx("input",{type:"text",id:"customerAddress",value:x.address,onChange:c=>R("address",c.target.value),className:`input-field ${C.address?"border-error-300 focus:border-error-500 focus:ring-error-500":""}`,placeholder:"Full address",disabled:o}),C.address&&e.jsx("p",{className:"error-message",children:C.address})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-2",children:[e.jsx("button",{type:"button",onClick:()=>{b(!1),v({name:"",email:"",phone:"",address:""}),I({})},className:"btn-secondary text-sm",disabled:o,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary text-sm",disabled:o,children:o?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"inline-block w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Creating..."]}):"✅ Create Customer"})]})]})]}):e.jsxs(e.Fragment,{children:[j?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"loading-spinner"})}):e.jsxs("select",{id:"customerId",value:s.customerId,onChange:c=>T("customerId",c.target.value),className:`input-field ${p.customerId?"border-error-300 focus:border-error-500 focus:ring-error-500":""}`,disabled:i,children:[e.jsx("option",{value:"",children:"Select a customer"}),d.map(c=>e.jsxs("option",{value:c.customerId,children:[c.name," (",c.email,")"]},c.customerId))]}),p.customerId&&e.jsx("p",{className:"error-message",children:p.customerId}),d.length===0&&!j&&e.jsxs("div",{className:"text-sm text-blue-600 mt-1 p-3 bg-blue-50 rounded border border-blue-200",children:[e.jsx("p",{className:"font-medium",children:"No customers found"}),e.jsx("p",{children:'Click "Add New Customer" above to create your first customer.'})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-gray-700 mb-1",children:"Loan Amount (₹) *"}),e.jsx("input",{type:"number",id:"amount",step:"0.01",min:"1000",max:"100000000",value:s.amount,onChange:c=>T("amount",c.target.value),className:`input-field ${p.amount?"border-error-300 focus:border-error-500 focus:ring-error-500":""}`,placeholder:"500000",disabled:i}),p.amount&&e.jsx("p",{className:"error-message",children:p.amount})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"interestRate",className:"block text-sm font-medium text-gray-700 mb-1",children:"Annual Interest Rate (%) *"}),e.jsx("input",{type:"number",id:"interestRate",step:"0.01",min:"0.1",max:"50",value:s.interestRate,onChange:c=>T("interestRate",c.target.value),className:`input-field ${p.interestRate?"border-error-300 focus:border-error-500 focus:ring-error-500":""}`,placeholder:"5.5",disabled:i}),p.interestRate&&e.jsx("p",{className:"error-message",children:p.interestRate})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"term",className:"block text-sm font-medium text-gray-700 mb-1",children:"Loan Term (months) *"}),e.jsx("input",{type:"number",id:"term",min:"1",max:"360",value:s.term,onChange:c=>T("term",c.target.value),className:`input-field ${p.term?"border-error-300 focus:border-error-500 focus:ring-error-500":""}`,placeholder:"60",disabled:i}),p.term&&e.jsx("p",{className:"error-message",children:p.term}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:s.term&&!isNaN(parseInt(s.term))&&e.jsxs(e.Fragment,{children:["Equivalent to ",Math.round(parseInt(s.term)/12*10)/10," years"]})})]}),e.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[e.jsx("button",{type:"button",onClick:X,className:"btn-secondary",disabled:i,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary",disabled:i||d.length===0,children:i?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"inline-block w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Creating..."]}):"✅ Create Loan"})]})]})})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Payment Calculation"}),m?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-primary-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Monthly Payment"}),e.jsx("p",{className:"text-2xl font-bold text-primary-700",children:$(m.monthlyPayment)})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Principal:"}),e.jsx("span",{className:"font-medium",children:$(s.amount)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Total Interest:"}),e.jsx("span",{className:"font-medium",children:$(m.totalInterest)})]}),e.jsxs("div",{className:"flex justify-between border-t pt-2",children:[e.jsx("span",{className:"text-gray-500",children:"Total Amount:"}),e.jsx("span",{className:"font-bold",children:$(m.totalAmount)})]})]})]}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("div",{className:"text-4xl mb-2",children:"🧮"}),e.jsx("p",{children:"Enter loan details to see payment calculation"})]})]})})]})]})},W=({loanId:n,loan:r,onSuccess:h,onCancel:d,onNotification:t})=>{const[s,f]=u.useState({amount:"",paymentType:"EMI",paymentMethod:"bank_transfer",reference:""}),[i,N]=u.useState(!1),[j,k]=u.useState({}),p=()=>{try{const x={};if(!s.amount)x.amount="Payment amount is required";else{const v=parseFloat(s.amount);isNaN(v)||v<=0?x.amount="Amount must be a positive number":v<1?x.amount="Minimum payment amount is ₹1":v>r.remainingBalance&&(x.amount=`Payment cannot exceed remaining balance of ${l(r.remainingBalance)}`)}return s.paymentType||(x.paymentType="Payment type is required"),s.paymentMethod||(x.paymentMethod="Payment method is required"),k(x),Object.keys(x).length===0}catch(x){return console.error("Error validating form:",x),!1}},S=async x=>{x.preventDefault();try{if(!p())return;N(!0),k({});const v={amount:parseFloat(s.amount),paymentType:s.paymentType,paymentMethod:s.paymentMethod,reference:s.reference.trim()||void 0};await q.create(n,v),h&&h()}catch(v){console.error("Error recording payment:",v),t&&t({type:"error",message:`Failed to record payment: ${v.message}`})}finally{N(!1)}},m=(x,v)=>{try{f(o=>({...o,[x]:v})),j[x]&&k(o=>({...o,[x]:""}))}catch(o){console.error("Error handling form change:",o)}},l=x=>{try{return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(x||0)}catch(v){return console.error("Error formatting currency:",v),`₹${x||0}`}},a=()=>{try{d&&d()}catch(x){console.error("Error handling cancel:",x)}},b=x=>{switch(x){case"EMI":return"Regular monthly installment payment";case"LUMP_SUM":return"One-time bulk payment towards loan";default:return""}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Add Payment"}),e.jsx("button",{onClick:a,className:"btn-secondary",disabled:i,children:"← Back to Loan Details"})]}),e.jsx("div",{className:"card bg-gray-50",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Loan ID:"}),e.jsx("p",{className:"font-medium",children:r.loanId})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Remaining Balance:"}),e.jsx("p",{className:"font-medium text-warning-600",children:l(r.remainingBalance)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Monthly Payment:"}),e.jsx("p",{className:"font-medium",children:l(r.monthlyPayment)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Status:"}),e.jsx("p",{className:"font-medium",children:r.status})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{className:"card",children:e.jsxs("form",{onSubmit:S,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Amount (₹) *"}),e.jsx("input",{type:"number",id:"amount",step:"0.01",min:"1",max:r.remainingBalance,value:s.amount,onChange:x=>m("amount",x.target.value),className:`input-field ${j.amount?"border-error-300 focus:border-error-500 focus:ring-error-500":""}`,placeholder:"0.00",disabled:i}),j.amount&&e.jsx("p",{className:"error-message",children:j.amount}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Maximum: ",l(r.remainingBalance)]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"paymentType",className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Type *"}),e.jsxs("select",{id:"paymentType",value:s.paymentType,onChange:x=>m("paymentType",x.target.value),className:`input-field ${j.paymentType?"border-error-300 focus:border-error-500 focus:ring-error-500":""}`,disabled:i,children:[e.jsx("option",{value:"EMI",children:"EMI - Regular Monthly Payment"}),e.jsx("option",{value:"LUMP_SUM",children:"Lump Sum - One-time Payment"})]}),j.paymentType&&e.jsx("p",{className:"error-message",children:j.paymentType}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:b(s.paymentType)})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"paymentMethod",className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method *"}),e.jsxs("select",{id:"paymentMethod",value:s.paymentMethod,onChange:x=>m("paymentMethod",x.target.value),className:`input-field ${j.paymentMethod?"border-error-300 focus:border-error-500 focus:ring-error-500":""}`,disabled:i,children:[e.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),e.jsx("option",{value:"cash",children:"Cash"}),e.jsx("option",{value:"check",children:"Check"}),e.jsx("option",{value:"credit_card",children:"Credit Card"}),e.jsx("option",{value:"debit_card",children:"Debit Card"})]}),j.paymentMethod&&e.jsx("p",{className:"error-message",children:j.paymentMethod})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"reference",className:"block text-sm font-medium text-gray-700 mb-1",children:"Reference (Optional)"}),e.jsx("input",{type:"text",id:"reference",value:s.reference,onChange:x=>m("reference",x.target.value),className:"input-field",placeholder:"Transaction ID, check number, etc.",disabled:i,maxLength:100}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Add any reference information for this payment"})]}),e.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[e.jsx("button",{type:"button",onClick:a,className:"btn-secondary",disabled:i,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-success",disabled:i,children:i?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"inline-block w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Recording..."]}):"✅ Record Payment"})]})]})}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Payment Options"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{type:"button",onClick:()=>m("amount",r.monthlyPayment.toString()),className:"w-full text-left p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",disabled:i,children:[e.jsx("div",{className:"font-medium text-gray-900",children:"Monthly EMI Payment"}),e.jsx("div",{className:"text-sm text-gray-500",children:l(r.monthlyPayment)})]}),e.jsxs("button",{type:"button",onClick:()=>m("amount",r.remainingBalance.toString()),className:"w-full text-left p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",disabled:i,children:[e.jsx("div",{className:"font-medium text-gray-900",children:"Pay Full Balance"}),e.jsx("div",{className:"text-sm text-gray-500",children:l(r.remainingBalance)})]}),e.jsxs("button",{type:"button",onClick:()=>m("amount",(r.remainingBalance/2).toFixed(2)),className:"w-full text-left p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",disabled:i,children:[e.jsx("div",{className:"font-medium text-gray-900",children:"Pay Half Balance"}),e.jsx("div",{className:"text-sm text-gray-500",children:l(r.remainingBalance/2)})]})]}),s.amount&&!isNaN(parseFloat(s.amount))&&e.jsxs("div",{className:"mt-6 p-4 bg-primary-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-primary-900 mb-2",children:"Payment Impact"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-primary-700",children:"New Balance:"}),e.jsx("span",{className:"font-medium text-primary-900",children:l(Math.max(0,r.remainingBalance-parseFloat(s.amount)))})]}),parseFloat(s.amount)>=r.remainingBalance&&e.jsx("div",{className:"text-success-600 font-medium",children:"✅ This payment will fully pay off the loan!"})]})]})]})]})]})},ue=({loanId:n,onBack:r,onNotification:h,onUpdate:d})=>{const[t,s]=u.useState(null),[f,i]=u.useState([]),[N,j]=u.useState(!0),[k,p]=u.useState(null),[S,m]=u.useState(!1);u.useEffect(()=>{n&&(l(),a())},[n]);const l=async()=>{try{const y=await _.getById(n);s(y.data.data)}catch(y){console.error("Error fetching loan details:",y),p(y.message),h&&h({type:"error",message:`Failed to load loan details: ${y.message}`})}},a=async()=>{try{const y=await q.getByLoan(n);i(y.data.data||[])}catch(y){console.error("Error fetching payments:",y),h&&h({type:"error",message:`Failed to load payments: ${y.message}`})}finally{j(!1)}},b=()=>{try{m(!1),l(),a(),d&&d(),h&&h({type:"success",message:"Payment recorded successfully!"})}catch(y){console.error("Error handling payment addition:",y)}},x=y=>{try{return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(y||0)}catch(F){return console.error("Error formatting currency:",F),`₹${y||0}`}},v=y=>{try{return new Date(y).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch(F){return console.error("Error formatting date:",F),"Invalid Date"}},o=y=>{switch(y==null?void 0:y.toLowerCase()){case"pending":return"status-pending";case"active":return"status-active";case"paid_off":return"status-paid_off";case"completed":return"status-completed";case"failed":return"status-failed";default:return"status-pending"}},g=()=>{try{if(!t||!t.totalAmount||t.totalAmount===0)return 0;const y=t.totalAmount-t.remainingBalance;return Math.round(y/t.totalAmount*100)}catch(y){return console.error("Error calculating progress:",y),0}},C=()=>{try{r&&r()}catch(y){console.error("Error handling back:",y)}};if(N)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"loading-spinner"})});if(k||!t)return e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-error-600 mb-4",children:"⚠️ Error Loading Loan"}),e.jsx("p",{className:"text-gray-500 mb-4",children:k||"Loan not found"}),e.jsx("button",{onClick:C,className:"btn-primary",children:"← Back to Loans"})]});if(S)return e.jsx(W,{loanId:n,loan:t,onSuccess:b,onCancel:()=>m(!1),onNotification:h});const I=g(),D=t.totalAmount-t.remainingBalance;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:C,className:"btn-secondary",children:"← Back"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Loan Details"})]}),t.status==="ACTIVE"&&t.remainingBalance>0&&e.jsx("button",{onClick:()=>m(!0),className:"btn-primary",children:"➕ Add Payment"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 card",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:["Loan ",t.loanId]}),e.jsx("span",{className:o(t.status),children:t.status})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:x(t.amount)}),e.jsx("p",{className:"text-sm text-gray-500",children:"Principal Amount"})]})]}),t.customer&&e.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Customer Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Name:"}),e.jsx("p",{className:"font-medium",children:t.customer.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Email:"}),e.jsx("p",{className:"font-medium",children:t.customer.email})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Phone:"}),e.jsx("p",{className:"font-medium",children:t.customer.phone})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Address:"}),e.jsx("p",{className:"font-medium",children:t.customer.address})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Interest Rate:"}),e.jsxs("p",{className:"font-semibold text-lg",children:[t.interestRate,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Term:"}),e.jsxs("p",{className:"font-semibold text-lg",children:[t.term," months"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Monthly Payment:"}),e.jsx("p",{className:"font-semibold text-lg",children:x(t.monthlyPayment)})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Payment Progress"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[e.jsx("span",{children:"Paid"}),e.jsxs("span",{children:[I,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-success-600 h-2 rounded-full transition-all duration-300",style:{width:`${I}%`}})})]}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Total Amount:"}),e.jsx("span",{className:"font-medium",children:x(t.totalAmount)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Paid:"}),e.jsx("span",{className:"font-medium text-success-600",children:x(D)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Remaining:"}),e.jsx("span",{className:"font-medium text-warning-600",children:x(t.remainingBalance)})]})]}),t.status==="PAID_OFF"&&e.jsx("div",{className:"mt-4 p-3 bg-success-50 border border-success-200 rounded-lg",children:e.jsx("p",{className:"text-success-800 text-sm font-medium",children:"✅ Loan fully paid!"})})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Payment History"}),f.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-2",children:"💳"}),e.jsx("p",{className:"text-gray-500",children:"No payments recorded yet"}),t.status==="ACTIVE"&&e.jsx("button",{onClick:()=>m(!0),className:"btn-primary mt-4",children:"➕ Add First Payment"})]}):e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Payment ID"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Method"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Reference"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:f.map(y=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("code",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:y.paymentId})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-success-600",children:x(y.amount)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:y.paymentType}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:y.paymentMethod.replace("_"," ")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:v(y.paymentDate)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:y.reference||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:o(y.status),children:y.status})})]},y.paymentId))})]})})]})]})},he=({onNotification:n})=>{const[r,h]=u.useState([]),[d,t]=u.useState(!0),[s,f]=u.useState(null),[i,N]=u.useState(!1),[j,k]=u.useState(null),[p,S]=u.useState({status:"",search:""});u.useEffect(()=>{m()},[]);const m=async()=>{try{t(!0),f(null);const o={};p.status&&(o.status=p.status);const g=await _.getAll(o);h(g.data.data||[])}catch(o){console.error("Loan fetch error:",o),f(o.message),n&&n({type:"error",message:`Failed to load loans: ${o.message}`})}finally{t(!1)}},l=()=>{try{N(!1),m(),n&&n({type:"success",message:"Loan created successfully!"})}catch(o){console.error("Error handling loan creation:",o)}},a=o=>{try{return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(o||0)}catch(g){return console.error("Error formatting currency:",g),`₹${o||0}`}},b=o=>{try{return new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch(g){return console.error("Error formatting date:",g),"Invalid Date"}},x=o=>{switch(o==null?void 0:o.toLowerCase()){case"active":return"status-active";case"paid_off":return"status-paid_off";case"pending":return"status-pending";case"completed":return"status-completed";default:return"status-pending"}},v=r.filter(o=>{var g,C,I,D,y,F;try{if(!p.search)return!0;const L=p.search.toLowerCase();return((g=o.loanId)==null?void 0:g.toLowerCase().includes(L))||((I=(C=o.customer)==null?void 0:C.name)==null?void 0:I.toLowerCase().includes(L))||((y=(D=o.customer)==null?void 0:D.email)==null?void 0:y.toLowerCase().includes(L))||((F=o.customerId)==null?void 0:F.toLowerCase().includes(L))}catch(L){return console.error("Error filtering loans:",L),!0}});return i?e.jsx(Y,{onSuccess:l,onCancel:()=>N(!1),onNotification:n}):j?e.jsx(ue,{loanId:j,onBack:()=>k(null),onNotification:n,onUpdate:m}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Loans"}),e.jsx("button",{onClick:()=>N(!0),className:"btn-primary",children:"➕ Create Loan"})]}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsx("div",{className:"flex-1 min-w-64",children:e.jsx("input",{type:"text",placeholder:"Search loans, customers, or loan IDs...",value:p.search,onChange:o=>S(g=>({...g,search:o.target.value})),className:"input-field"})}),e.jsx("div",{children:e.jsxs("select",{value:p.status,onChange:o=>S(g=>({...g,status:o.target.value})),className:"input-field",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"ACTIVE",children:"Active"}),e.jsx("option",{value:"PAID_OFF",children:"Paid Off"})]})}),e.jsx("button",{onClick:m,className:"btn-secondary",disabled:d,children:"🔄 Refresh"})]}),d&&e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"loading-spinner"})}),s&&!d&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-error-600 mb-4",children:"⚠️ Error Loading Loans"}),e.jsx("p",{className:"text-gray-500 mb-4",children:s}),e.jsx("button",{onClick:m,className:"btn-primary",children:"🔄 Retry"})]}),!d&&!s&&e.jsxs("div",{className:"card",children:[v.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-6xl mb-4",children:"💰"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:p.search||p.status?"No loans found":"No loans yet"}),e.jsx("p",{className:"text-gray-500 mb-4",children:p.search||p.status?"Try adjusting your search criteria":"Create your first loan to get started"}),!p.search&&!p.status&&e.jsx("button",{onClick:()=>N(!0),className:"btn-primary",children:"➕ Create Loan"})]}):e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Loan ID"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Terms"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:v.map(o=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("code",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:o.loanId})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:o.customer?o.customer.name:"Unknown"}),e.jsx("div",{className:"text-sm text-gray-500",children:o.customer?o.customer.email:o.customerId})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:a(o.amount)}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Balance: ",a(o.remainingBalance)]})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[e.jsxs("div",{children:[o.interestRate,"% APR"]}),e.jsxs("div",{children:[o.term," months"]}),e.jsxs("div",{children:[a(o.monthlyPayment),"/month"]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:x(o.status),children:o.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:b(o.createdAt)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsx("button",{onClick:()=>k(o.loanId),className:"text-primary-600 hover:text-primary-900",children:"View Details"})})]},o.loanId))})]})}),v.length>0&&e.jsx("div",{className:"bg-gray-50 px-6 py-3 border-t border-gray-200",children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",v.length," of ",r.length," loans"]})})]})]})},pe=({onNotification:n})=>{const[r,h]=u.useState([]),[d,t]=u.useState(!0),[s,f]=u.useState(null),[i,N]=u.useState({search:"",paymentMethod:"",status:""});u.useEffect(()=>{j()},[]);const j=async()=>{try{t(!0),f(null);const x=((await _.getAll()).data.data||[]).map(async g=>{try{return((await q.getByLoan(g.loanId)).data.data||[]).map(D=>({...D,loan:{loanId:g.loanId,customer:g.customer}}))}catch(C){return console.error(`Error fetching payments for loan ${g.loanId}:`,C),[]}}),o=(await Promise.all(x)).flat();o.sort((g,C)=>new Date(C.paymentDate)-new Date(g.paymentDate)),h(o)}catch(a){console.error("Error fetching payments:",a),f(a.message),n&&n({type:"error",message:`Failed to load payments: ${a.message}`})}finally{t(!1)}},k=a=>{try{return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a||0)}catch(b){return console.error("Error formatting currency:",b),`$${a||0}`}},p=a=>{try{return new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch(b){return console.error("Error formatting date:",b),"Invalid Date"}},S=a=>{switch(a==null?void 0:a.toLowerCase()){case"pending":return"status-pending";case"completed":return"status-completed";case"failed":return"status-failed";default:return"status-pending"}},m=r.filter(a=>{var b,x,v,o,g,C,I,D,y,F;try{if(i.search){const L=i.search.toLowerCase();if(!(((b=a.paymentId)==null?void 0:b.toLowerCase().includes(L))||((v=(x=a.loan)==null?void 0:x.loanId)==null?void 0:v.toLowerCase().includes(L))||((C=(g=(o=a.loan)==null?void 0:o.customer)==null?void 0:g.name)==null?void 0:C.toLowerCase().includes(L))||((y=(D=(I=a.loan)==null?void 0:I.customer)==null?void 0:D.email)==null?void 0:y.toLowerCase().includes(L))||((F=a.reference)==null?void 0:F.toLowerCase().includes(L))))return!1}return!(i.paymentMethod&&a.paymentMethod!==i.paymentMethod||i.status&&a.status!==i.status)}catch(L){return console.error("Error filtering payments:",L),!0}}),l={totalPayments:m.length,totalAmount:m.reduce((a,b)=>a+(b.amount||0),0),completedPayments:m.filter(a=>a.status==="completed").length,pendingPayments:m.filter(a=>a.status==="pending").length};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Payment History"}),e.jsx("button",{onClick:j,className:"btn-secondary",disabled:d,children:"🔄 Refresh"})]}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsx("div",{className:"flex-1 min-w-64",children:e.jsx("input",{type:"text",placeholder:"Search payments, loans, customers, or references...",value:i.search,onChange:a=>N(b=>({...b,search:a.target.value})),className:"input-field"})}),e.jsx("div",{children:e.jsxs("select",{value:i.paymentMethod,onChange:a=>N(b=>({...b,paymentMethod:a.target.value})),className:"input-field",children:[e.jsx("option",{value:"",children:"All Methods"}),e.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),e.jsx("option",{value:"cash",children:"Cash"}),e.jsx("option",{value:"check",children:"Check"}),e.jsx("option",{value:"credit_card",children:"Credit Card"}),e.jsx("option",{value:"debit_card",children:"Debit Card"})]})}),e.jsx("div",{children:e.jsxs("select",{value:i.status,onChange:a=>N(b=>({...b,status:a.target.value})),className:"input-field",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"failed",children:"Failed"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Total Payments"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:l.totalPayments})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Total Amount"}),e.jsx("div",{className:"text-2xl font-bold text-success-600",children:k(l.totalAmount)})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Completed"}),e.jsx("div",{className:"text-2xl font-bold text-success-600",children:l.completedPayments})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Pending"}),e.jsx("div",{className:"text-2xl font-bold text-warning-600",children:l.pendingPayments})]})]}),d&&e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"loading-spinner"})}),s&&!d&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-error-600 mb-4",children:"⚠️ Error Loading Payments"}),e.jsx("p",{className:"text-gray-500 mb-4",children:s}),e.jsx("button",{onClick:j,className:"btn-primary",children:"🔄 Retry"})]}),!d&&!s&&e.jsxs("div",{className:"card",children:[m.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-6xl mb-4",children:"💳"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:i.search||i.paymentMethod||i.status?"No payments found":"No payments yet"}),e.jsx("p",{className:"text-gray-500 mb-4",children:i.search||i.paymentMethod||i.status?"Try adjusting your search criteria":"Payments will appear here once loans are created and payments are made"})]}):e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Payment ID"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Loan"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Method"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:m.map(a=>{var b,x,v,o,g,C;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("code",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:a.paymentId})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("code",{className:"text-xs bg-primary-100 text-primary-800 px-2 py-1 rounded",children:((b=a.loan)==null?void 0:b.loanId)||"Unknown"})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:((v=(x=a.loan)==null?void 0:x.customer)==null?void 0:v.name)||"Unknown"}),e.jsx("div",{className:"text-sm text-gray-500",children:((g=(o=a.loan)==null?void 0:o.customer)==null?void 0:g.email)||"-"})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-success-600",children:k(a.amount)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:a.paymentType}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:((C=a.paymentMethod)==null?void 0:C.replace("_"," "))||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:p(a.paymentDate)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:S(a.status),children:a.status})})]},a.paymentId)})})]})}),m.length>0&&e.jsx("div",{className:"bg-gray-50 px-6 py-3 border-t border-gray-200",children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",m.length," of ",r.length," payments"]})})]})]})},ye=({onNotification:n})=>{var k,p,S,m;const[r,h]=u.useState(null),[d,t]=u.useState(!0),[s,f]=u.useState(!1);u.useEffect(()=>{i()},[]);const i=async()=>{try{t(!0);const a=await(await fetch("/health")).json();if(a.status==="OK")h({connection:a.database==="connected"?"connected":"disconnected",database:"lendflow",collections:[{name:"customers",count:"Loading..."},{name:"loans",count:"Loading..."},{name:"payments",count:"Loading..."}],dbStats:{collections:3,objects:"Loading..."}});else throw new Error(a.message||"Failed to fetch status")}catch(l){console.error("Error fetching database status:",l),h({connection:"disconnected",database:"lendflow",collections:[],dbStats:{collections:0,objects:0}}),n&&n({type:"error",message:`Database connection check failed: ${l.message}`})}finally{t(!1)}},N=async()=>{try{f(!0),n&&n({type:"info",message:"Database backup feature is available. The database is connected and operational."})}catch(l){console.error("Error creating backup:",l),n&&n({type:"error",message:`Failed to create backup: ${l.message}`})}finally{f(!1)}},j=async()=>{if(window.confirm("This will add sample data to your database. Continue?"))try{f(!0),n&&n({type:"info",message:"Database seeding feature is available. You can add sample customers and loans through the respective forms."}),await i()}catch(l){console.error("Error seeding database:",l),n&&n({type:"error",message:`Failed to seed database: ${l.message}`})}finally{f(!1)}};return d?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Database Management"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${(r==null?void 0:r.connection)==="connected"?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:"text-sm text-gray-600",children:(r==null?void 0:r.connection)==="connected"?"Connected":"Disconnected"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Database Info"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Database:"}),e.jsx("span",{className:"font-medium",children:(r==null?void 0:r.database)||"lendflow"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Collections:"}),e.jsx("span",{className:"font-medium",children:((k=r==null?void 0:r.dbStats)==null?void 0:k.collections)||"Loading..."})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Total Objects:"}),e.jsx("span",{className:"font-medium",children:((S=(p=r==null?void 0:r.dbStats)==null?void 0:p.objects)==null?void 0:S.toLocaleString())||"Loading..."})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:N,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg transition-colors text-sm",disabled:s,children:"📥 Download Backup"}),e.jsx("button",{onClick:j,className:"w-full bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-2 px-4 rounded-lg transition-colors text-sm",disabled:s,children:"🌱 Seed Sample Data"}),e.jsx("button",{onClick:i,className:"w-full bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-2 px-4 rounded-lg transition-colors text-sm",disabled:s,children:"🔄 Refresh Status"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Collections"}),(m=r==null?void 0:r.collections)==null?void 0:m.map(l=>e.jsxs("div",{className:"flex justify-between items-center py-2",children:[e.jsx("span",{className:"text-sm font-medium capitalize",children:l.name}),e.jsx("span",{className:"text-sm text-gray-500",children:l.count})]},l.name))]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:"💡 Database Tips"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{children:"• All monetary values are stored and displayed in Indian Rupees (₹)"}),e.jsx("p",{children:"• Regular backups help protect your data"}),e.jsx("p",{children:"• Use the seed data feature to test with sample records"})]})]})]})},ge=({notification:n,onClose:r})=>{if(u.useEffect(()=>{try{if(n){const s=setTimeout(()=>{r()},5e3);return()=>clearTimeout(s)}}catch(s){console.error("Error in notification timer:",s)}},[n,r]),!n)return null;const h=s=>{switch(s){case"success":return"bg-success-50 border-success-200 text-success-800";case"error":return"bg-error-50 border-error-200 text-error-800";case"warning":return"bg-warning-50 border-warning-200 text-warning-800";default:return"bg-primary-50 border-primary-200 text-primary-800"}},d=s=>{switch(s){case"success":return"✅";case"error":return"❌";case"warning":return"⚠️";default:return"ℹ️"}},t=()=>{try{r()}catch(s){console.error("Error closing notification:",s)}};return e.jsx("div",{className:"fixed top-4 right-4 z-50 animate-fade-in",children:e.jsx("div",{className:`max-w-sm w-full rounded-lg border p-4 shadow-lg ${h(n.type)}`,children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("span",{className:"text-lg",children:d(n.type)})}),e.jsx("div",{className:"ml-3 w-0 flex-1",children:e.jsx("p",{className:"text-sm font-medium",children:n.message})}),e.jsx("div",{className:"ml-4 flex-shrink-0 flex",children:e.jsxs("button",{onClick:t,className:"rounded-md inline-flex text-gray-400 hover:text-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[e.jsx("span",{className:"sr-only",children:"Close"}),e.jsx("span",{className:"text-lg",children:"×"})]})})]})})})};function fe(){const[n,r]=u.useState("dashboard"),[h,d]=u.useState(null),t=i=>{try{d(i),setTimeout(()=>{d(null)},5e3)}catch(N){console.error("Error handling notification:",N)}},s=()=>{try{d(null)}catch(i){console.error("Error clearing notification:",i)}},f=()=>{try{switch(n){case"dashboard":return e.jsx(H,{onNotification:t});case"customers":return e.jsx(xe,{onNotification:t});case"add-customer":return e.jsx(Q,{onNotification:t,onSuccess:()=>r("customers"),onBack:()=>r("customers")});case"loans":return e.jsx(he,{onNotification:t});case"add-loan":return e.jsx(Y,{onNotification:t,onSuccess:()=>r("loans"),onBack:()=>r("loans")});case"payments":return e.jsx(pe,{onNotification:t});case"add-payment":return e.jsx(W,{onNotification:t,onSuccess:()=>r("payments"),onBack:()=>r("payments")});case"database":return e.jsx(ye,{onNotification:t});default:return e.jsx(H,{onNotification:t})}}catch(i){return console.error("Error rendering view:",i),e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-red-600 mb-4",children:"⚠️ Application Error"}),e.jsx("p",{className:"text-gray-600",children:"Something went wrong. Please refresh the page."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg transition-colors mt-4",children:"Refresh Page"})]})}};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(oe,{currentView:n,onViewChange:r}),e.jsx("main",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:f()}),e.jsx(ge,{notification:h,onClose:s})]})}U.createRoot(document.getElementById("root")).render(e.jsx(se.StrictMode,{children:e.jsx(fe,{})}));
